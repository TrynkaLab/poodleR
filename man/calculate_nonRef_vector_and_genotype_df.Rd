% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_nonRef_vector_and_genotype_df.R
\name{calculate_nonRef_vector_and_genotype_df}
\alias{calculate_nonRef_vector_and_genotype_df}
\title{Calculate Non-Reference Allele Frequencies and Genotype Dosages}
\usage{
calculate_nonRef_vector_and_genotype_df(
  bam_readcount_path,
  vcf_path,
  min_read_overlap = 1,
  b_estimate_path = NULL,
  variants_retained_path = NULL,
  genotype_minor_allele_dos_path = NULL
)
}
\arguments{
\item{bam_readcount_path}{Path to the bam-readcount file (compressed \code{.gz}).}

\item{vcf_path}{Path to the VCF file containing variant data.}

\item{min_read_overlap}{Minimum number of reads required to retain a SNP (default = 1)}

\item{b_estimate_path}{Optional path to save minor allele frequency estimates.}

\item{variants_retained_path}{Optional path to save statistics on retained variants.}

\item{genotype_minor_allele_dos_path}{Optional path to save minor allele dosage data.}
}
\value{
A list containing:
\itemize{
\item \code{b_estimate_table}: A data.table with estimated non-reference allele frequencies.
\item \code{ma_dosages}: A data.table with minor allele dosages.
}
}
\description{
This function processes bam-readcount data and VCF files to estimate non-reference allele frequencies and minor allele dosages. It filters SNPs, matches variants between BAM and VCF data, and calculates minor allele frequency estimates.
}
\details{
\itemize{
\item Reads in bam-readcount and VCF files, retaining only relevant columns.
\item Filters out variants where the ALT allele is not A, C, T, or G.
\item Ensures SNPs have a minimum number of reads and removes duplicates.
\item Matches SNPs between bam-readcounts and the VCF file.
\item Calculates minor allele dosages using \code{create_gt_dosages()}.
\item Estimates non-reference allele frequencies using \code{estimate_b_from_bam_readcount()}.
\item Performs consistency checks to ensure data integrity.
\item Optionally saves intermediate results if file paths are provided.
}
}
\examples{
\dontrun{
bam_path = "path/to/bam_readcount.gz"
vcf_path = "path/to/variants.vcf"
result = calculate_nonRef_vector_and_genotype_df(bam_path, vcf_path, min_read_overlap = 10)
}

}
